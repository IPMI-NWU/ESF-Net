# ESF-Net
A breast tumor diagnosis network based on multi-sequence MRI fusion. The network is designed with an extended sequence fusion module under the premise of generating missing sequences in the input. It integrates multiple strategies for adaptively weighted fusion of different sequence features, so that the final fused features benefit from the feature enhancement brought by different fusion strategies, thereby improving network performance.

# Train:

Key files:

`Tumor_fusion_record_changeConv4` (includes network definition, training process, and saving of the network model)

`Tumor_fusion_record_changeConv4_ablation` is used for the ablation experiments of the fusion module in the article's comparative experiments and can be ignored.

`draw_ROC`: Code for plotting ROC curves of different results.

`ResNet_XXX`: Related experiments conducted on the baseline in the article.

`data_loader_XXX`: Loads different data under various conditions (the core file is data_loader_fake_fake_fake.py, which handles loading images generated by CycleGAN when input sequences are missing).

`compute_patientlevel_XXX`: Computes patient-level metrics under different experimental conditions.

# Test:

`test_pkl_XXX`: Retrieves the stored trained models under different conditions for result testing.
# Log Files:

Relevant information during the experiment is recorded in `run.log`, `val.log`, and `test.log`.



# Requirements
Some important required packages include:
* torch == 2.3.0
* torchvision == 0.18.0
* Python == 3.10.14
* numpy == 1.26.4